"""진로 관리 유틸리티 모듈

서가윤의 진로를 관리합니다. 각 사용자마다 랜덤한 진로를 할당하고 저장합니다.
수능을 통해 진학하여 이루어지는 직업들을 포함합니다.
"""

import random
from typing import Optional


# 진로 목록 (수능을 통해 진학하여 이루어지는 직업)
CAREER_OPTIONS = [
    # 의료 계열
    "임상심리사",
    
    # 법률 계열
    "변호사",
    "검사",
    "판사",
    "법무사",
    
    # 교육 계열
    "교사",
    "대학교수",
    "유치원교사",
    
    # 공무원 계열
    "행정고시",
    "외무고시",
    "법무고시",
    "입법고시",
    "5급공무원",
    "7급공무원",
    "경찰공무원",
    "소방공무원",
    
    # 공학 계열
    "토목기술자",
    "기계공학자",
    "전기전자공학자",
    "화학공학자",
    "컴퓨터공학자",
    "산업공학자",
    
    # 경제/경영 계열
    "회계사",
    "세무사",
    "관세사",
    "경영컨설턴트",
    "금융분석가",
    "투자분석가",
    
    # 언론/미디어 계열
    "기자",
    "PD",
    "작가",
    
    # 사회 계열
    "사회복지사",
    "상담사",
    "외교관",
    
    # 연구 계열
    "연구원",
    "연구개발원",
]


def get_random_career() -> str:
    """
    랜덤한 진로 선택
    
    Returns:
        진로명 (str)
    """
    return random.choice(CAREER_OPTIONS)


def get_career_description(career: str) -> str:
    """
    진로에 대한 간단한 설명 반환
    
    Args:
        career: 진로명
    
    Returns:
        진로 설명 (str)
    """
    descriptions = {
        # 의료 계열
        "임상심리사": "심리 문제를 상담하고 치료하는 전문가",
        
        # 법률 계열
        "변호사": "법률 문제를 해결하고 정의를 구현하는 법률 전문가",
        "검사": "범죄를 수사하고 기소하는 법률 전문가",
        "판사": "법률 분쟁을 판단하고 재판하는 법률 전문가",
        "법무사": "법률 서비스를 제공하고 법률 상담을 하는 전문가",
        
        # 교육 계열
        "교사": "다음 세대를 가르치고 교육하는 교육자",
        "대학교수": "대학에서 강의하고 연구하는 교육 전문가",
        "유치원교사": "유아를 교육하고 돌보는 교육 전문가",
        
        # 공무원 계열
        "행정고시": "행정 분야 고등고시를 통과한 공직자",
        "외무고시": "외교 분야 고등고시를 통과한 외교관",
        "법무고시": "법률 분야 고등고시를 통과한 법률 전문가",
        "입법고시": "입법 분야 고등고시를 통과한 공직자",
        "5급공무원": "5급 공무원으로 국가 정책을 담당하는 공직자",
        "7급공무원": "7급 공무원으로 행정 업무를 담당하는 공직자",
        "경찰공무원": "치안을 유지하고 범죄를 예방하는 공직자",
        "소방공무원": "화재를 진압하고 응급상황을 처리하는 공직자",
        
        # 공학 계열
        "엔지니어": "공학적 지식을 활용하여 문제를 해결하는 기술 전문가",
        "건축가": "건물을 설계하고 공간을 창조하는 전문가",
        "토목기술자": "도로, 교량, 건물 등의 토목 공사를 담당하는 전문가",
        "기계공학자": "기계를 설계하고 기계 공학을 담당하는 전문가",
        "전기전자공학자": "전자 제품을 개발하고 전자 시스템을 설계하는 전문가",
        "화학공학자": "화학 공정을 설계하고 화학 공업을 담당하는 전문가",
        "컴퓨터공학자": "소프트웨어를 개발하고 컴퓨터 시스템을 설계하는 전문가",
        "산업공학자": "산업 공정을 최적화하고 효율성을 높이는 전문가",
        
        # 경제/경영 계열
        "회계사": "재무를 관리하고 회계 업무를 처리하는 전문가",
        "세무사": "세무 업무를 대행하고 세무 상담을 제공하는 전문가",
        "관세사": "관세 업무를 대행하고 무역 절차를 지원하는 전문가",
        "경영컨설턴트": "기업의 경영 문제를 해결하고 성장을 돕는 전문가",
        "금융분석가": "금융 시장을 분석하고 투자 전략을 수립하는 전문가",
        "투자분석가": "투자 기회를 분석하고 투자 전략을 수립하는 전문가",
        
        # 언론/미디어 계열
        "기자": "사회의 소식을 전달하고 보도를 하는 언론인",
        "PD": "방송 프로그램을 기획하고 제작하는 제작자",
        "작가": "글을 쓰고 창작 활동을 하는 문학가",
        
        # 사회 계열
        "사회복지사": "취약계층을 지원하고 복지 서비스를 제공하는 전문가",
        "상담사": "개인의 문제를 상담하고 해결을 돕는 전문가",
        "외교관": "국제 관계를 담당하고 외교 활동을 수행하는 공직자",
        
        # 연구 계열
        "연구원": "새로운 지식과 기술을 발견하는 연구자",
        "연구개발원": "새로운 제품과 기술을 연구하고 개발하는 전문가",
    }
    
    return descriptions.get(career, f"{career}로 진출하는 것을 목표로 하고 있어요.")


def get_career_related_subjects(career: str) -> list:
    """
    진로와 관련된 선택과목 목록 반환
    
    Args:
        career: 진로명
    
    Returns:
        관련 선택과목 리스트 (예: ["생명과학1", "화학1"])
    """
    # 진로별 관련 과목 매핑
    career_subject_map = {
        # 의료 계열
        "임상심리사": ["생활과윤리", "윤리와사상"],
        
        # 법률 계열
        "변호사": ["사회문화", "정치와법", "세계사"],
        "검사": ["사회문화", "정치와법", "세계사"],
        "판사": ["사회문화", "정치와법", "세계사"],
        "법무사": ["사회문화", "정치와법"],
        
        # 교육 계열
        "교사": ["사회문화", "세계사", "동아시아사"],
        "대학교수": ["세계사", "동아시아사"],
        "유치원교사": ["생활과윤리"],
        
        # 공무원 계열
        "행정고시": ["사회문화", "정치와법", "경제"],
        "외무고시": ["세계사", "동아시아사", "세계지리", "정치와법"],
        "법무고시": ["사회문화", "정치와법", "세계사"],
        "입법고시": ["사회문화", "정치와법", "경제"],
        "5급공무원": ["사회문화", "정치와법", "경제"],
        "7급공무원": ["사회문화", "정치와법"],
        "경찰공무원": ["사회문화", "정치와법"],
        "소방공무원": ["물리학1"],
        
        # 공학 계열
        "엔지니어": ["물리학1", "물리학2", "화학1"],
        "건축가": ["물리학1", "물리학2"],
        "토목기술자": ["물리학1", "물리학2", "지구과학1"],
        "기계공학자": ["물리학1", "물리학2"],
        "전기전자공학자": ["물리학1", "물리학2"],
        "화학공학자": ["화학1", "화학2", "물리학1"],
        "컴퓨터공학자": ["물리학1", "물리학2"],
        "산업공학자": ["물리학1", "물리학2"],
        
        # 경제/경영 계열
        "회계사": ["경제"],
        "세무사": ["경제"],
        "관세사": ["경제", "정치와법"],
        "경영컨설턴트": ["경제", "정치와법"],
        "금융분석가": ["경제"],
        "투자분석가": ["경제", "정치와법"],
        
        # 언론/미디어 계열
        "기자": ["사회문화", "세계사", "동아시아사"],
        "PD": ["사회문화", "세계사"],
        "작가": ["세계사", "동아시아사", "한국지리"],
        
        # 사회 계열
        "사회복지사": ["사회문화", "생활과윤리"],
        "상담사": ["생활과윤리", "윤리와사상"],
        "외교관": ["세계사", "동아시아사", "세계지리", "정치와법"],
        
        # 연구 계열
        "연구원": ["물리학1", "화학1", "생명과학1", "지구과학1"],
        "연구개발원": ["물리학1", "물리학2", "화학1", "화학2"],
    }
    
    return career_subject_map.get(career, [])


def get_career_subject_bonus_multiplier(career: str, subject: str) -> float:
    """
    진로와 선택과목의 관련성을 확인하여 배율 반환
    
    Args:
        career: 진로명
        subject: 선택과목명 (예: "생명과학1", "사회문화")
    
    Returns:
        배율 (float) - 관련이 있으면 1.2, 없으면 1.0
    """
    if not career:
        return 1.0
    
    related_subjects = get_career_related_subjects(career)
    
    # 과목명이 관련 목록에 포함되어 있는지 확인
    if subject in related_subjects:
        return 1.2  # 20% 증가
    
    return 1.0  # 기본 배율


def initialize_career_for_user(username: str, existing_career: Optional[str] = None) -> str:
    """
    사용자에게 진로 초기화 (기존 진로가 없으면 랜덤 선택)
    
    Args:
        username: 사용자 이름
        existing_career: 기존에 저장된 진로 (None이면 새로 생성)
    
    Returns:
        진로명 (str)
    """
    if existing_career:
        return existing_career
    
    career = get_random_career()
    print(f"[CAREER] {username}의 진로가 '{career}'로 설정되었습니다.")
    return career


